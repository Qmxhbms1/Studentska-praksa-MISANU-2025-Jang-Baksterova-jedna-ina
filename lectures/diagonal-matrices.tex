\documentclass{article}

\input{lectures-preamble.tex}

\title{Yang-Baxter-like matrix equations}
\author{Mihailo Đurić}
\date{\today}

\begin{document}

\maketitle
\tableofcontents
\newpage

\section{Diagonal Matrices}
If we have a diagonal matrix $A$, it makes sense to build on our previous work by using the core-nilpotent decomposition.
Here the matrix $A$ decomposes into a $0$ matrix and an invertible, diagonal matrix $A_2$.
Considering $X$ as a $2 \times 2$ block matrix, our previous system of equation simplifies to
\[\begin{cases}
  X_2 A_2 X_3 = 0\\
  X_2 A_2 X_4 = 0\\
  X_4 A_2 X_3 = 0\\
  A_2 X_4 A_2 = X_4 A_2 X_4
\end{cases}\]
For the solutions to be commuting we can again find the following system
\[\begin{cases}
  X_2 A_2 = 0\\
  A_2 X_3 = 0\\
  A_2 X_4 = X_4 A_2
\end{cases}\]
Since $A_2$ is invertible, it follows that it is not a zero-divisor, thus we know that $X_2 = X_3 = 0$.
All commuting solutions for $X_4$ can be given by the Theorem \ref{invertible}.
Thus all commuting solutions for a diagonal matrix are given by an arbitrary $X_1$, $X_2 = X_3 = 0$ and a commuting solution to $A_2 X_4 A_2 = X_4 A_2 X_4$.

The commuting solution were already known, so we are interested in any solution not satisfying the previous equations.
These solutions either have a non-commuting solution for $X_4$ or a non-zero $X_2$ or $X_3$.

We now present a procedure to construct the complete set of solutions to this system.
We proceed under the assumption that the solution set for the fourth equation, the Yang-Baxter-like equation $A_2 X_4 A_2 = X_4 A_2 X_4$, is known.
This set, which is the focus of other parts of this research, will be denoted by $S_4$.
The following proposition provides a constructive algorithm that generates all solutions for the full block matrix $X$.

\begin{theorem} \label{prop:constructive_solution}
Let $A = \text{diag}(0, A_2)$ be a block diagonal matrix where the zero block is of size $(n - m) \times (n - m)$ and $A_2$ is an $m \times m$ invertible, diagonal matrix.
  Let $X = \begin{bmatrix} X_1 & X_2\\ X_3 & X_4 \end{bmatrix}$ be a block matrix of compatible dimensions.
  The matrix $X$ is a solution to $AXA = XAX$ if and only if its constituent blocks are determined by the following procedure:
  \begin{enumerate}
    \item Choose an arbitrary matrix $X_4^* \in S_4$.
    \item Let $N(X_4^*)$ denote the null space of the chosen $X_4^*$.
      Construct the matrix $X_3$ such that its column space, $C(X_3)$, is a subspace of $A_2^{-1}(N(X_4^*))$.
    \item Based on the chosen $X_3$ and $X_4^*$, define the subspace $S = \text{span}(C(A_2 X_3) \cup C(A_2 X_4^*))$.
      Construct the matrix $X_2$ such that its null space, $N(X_2)$, contains the subspace $S$.
    \item Choose $X_1$ to be any arbitrary $(n - m) \times (n - m)$ matrix.
  \end{enumerate}
\end{theorem}

\begin{proof}
  The equation $AXA = XAX$ for the given block matrices simplifies to the system:
  \begin{align}
    X_2 A_2 X_3 &= 0 \label{eq:sys1}\\
    X_2 A_2 X_4 &= 0 \label{eq:sys2}\\
    X_4 A_2 X_3 &= 0 \label{eq:sys3}\\
    A_2 X_4 A_2 &= X_4 A_2 X_4 \label{eq:sys4}
  \end{align}
  We prove that the procedure in Theorem \ref{prop:constructive_solution} is both necessary and sufficient to define the complete solution set for this system.

  \textbf{(Sufficiency)}
  Assume a matrix $X$ is constructed according to the procedure.
  By Step 1, $X_4^*$ is in $S_4$, so equation \eqref{eq:sys4} is satisfied by definition.

  By Step 2, $C(X_3) \subset A_2^{-1} (N(X_4^*))$.
  This implies $C(A_2 X_3) \subset N(X_4^*)$, which is equivalent to the statement $X_4^* A_2 X_3 = 0$.
  Thus, equation \eqref{eq:sys3} is satisfied.

  By Step 3, $N(X_2)$ contains the subspace $S = \text{span}(C(A_2 X_3) \cup C(A_2 X_4^*))$.
  Since $C(A_2 X_3) \subset S \subset N(X_2)$, it follows that $X_2 A_2 X_3 = 0$.
  Thus, equation \eqref{eq:sys1} is satisfied.
  Similarly, since $C(A_2 X_4^*) \subset S \subset N(X_2)$, it follows that \eqref{eq:sys2} is satisfied.

  The matrix $X_1$ does not appear in any of the four equation, so its choice is unconstrained.

  Therefore, any matrix $X$ constructed via this procedure is a valid solution.

  \textbf{(Necessity)}
  Assume $(X_1, X_2, X_3, X_4)$ is a valid solution to the system \eqref{eq:sys1}-\eqref{eq:sys4}.
  We show that it must conform to the procedure.
  \begin{enumerate}
    \item Equation \eqref{eq:sys4} requires that $X_4$ must be a solution to the Yang-Baxter-like matrix equation for $A_2$.
      Therefore $X_4 \in S_4$, satisfying Step 1.
    \item From equation \eqref{eq:sys3}, $X_4 A_2 X_3 = 0$, we deduce that $C(A_2 X_3) \subset N(X_4)$.
      Since $A_2$ is invertible, this implies $C(X_3) \subset A_2^{-1} (N(X_4))$, satisfying the condition of Step 2.
    \item Equations \eqref{eq:sys1} and \eqref{eq:sys2} require that $X_2 A_2 X_3 = 0$ and $X_2 A_2 X_4 = 0$.
      This means the null space of $X_2$ must contain every column of $A_2 X_3$ and every column of $A_2 X_4$.
      Therefore, $N(X_2)$ must contain the span of their union, $S = \text{span} (C(A_2 X_3) \cup C(A_2 X_4)$.
      This is precisely the condition of Step 3.
    \item Since the matrix $X_1$ is not involved in any of the four equations, it is completely unconstrained and can be chosen arbitrarily.
      This conforms with Step 4.
  \end{enumerate}

  Thus, any solution to the system must be constructable via the stated procedure.
\end{proof}

This procedure already allows us to generate some solutions, as the commuting solutions for $X_4$ are known. To find all solutions, we require the entire set $\mathcal{S}_4$.

The general case for an arbitrary $A_2$ seems too difficult at present. We therefore restrict our analysis to a specific, illustrative case: an invertible, diagonal matrix $A_2$ with three distinct, non-zero eigenvalues. This means $A_2$ is of the form $A_2 = \text{diag}(\lambda_1 I, \lambda_2 I, \lambda_3 I)$. We partition a potential solution $X_4$ conformally with $A_2$ as 
\[
X_4 = 
\begin{bmatrix}
    X_{11} & X_{12} & X_{13} \\
    X_{21} & X_{22} & X_{23} \\
    X_{31} & X_{32} & X_{33}
\end{bmatrix}.
\]
Multiplying out the equation $A_2 X_4 A_2 = X_4 A_2 X_4$ yields a system of nine block matrix equations of the form:
\[
\lambda_i \lambda_j X_{ij} = \sum_{k = 1}^{3} \lambda_k X_{ik} X_{kj} \quad \text{for } i, j \in \{1, 2, 3\}.
\]

The equations where $i \neq j$ can be framed as Sylvester equations, but the full system remains coupled and difficult to solve. To make progress, we investigate a special family of solutions by imposing a structural constraint on $X_4$.


Let us search for solutions where $X_{12} = X_{13} = X_{32} = 0$. This simplifying assumption decouples the system considerably.

The equations for the diagonal blocks reduce to $\lambda_i^2 X_{ii} = \lambda_i X_{ii}^2$, which implies $\lambda_i X_{ii} = X_{ii}^2$ (since $\lambda_i \neq 0$). The minimal polynomial of $X_{ii}$ must divide $x(x-\lambda_i)$, which means each $X_{ii}$ must be diagonalizable with $\sigma(X_{ii}) \subseteq \{0, \lambda_i\}$.

The equations for the remaining off-diagonal blocks become three independent, homogeneous Sylvester equations:
\begin{enumerate}
    \item For $X_{21}$: $\lambda_2 \lambda_1 X_{21} = \lambda_1 X_{21} X_{11} + \lambda_2 X_{22} X_{21}$
    \item For $X_{23}$: $\lambda_2 \lambda_3 X_{23} = \lambda_2 X_{22} X_{23} + \lambda_3 X_{23} X_{33}$
    \item For $X_{31}$: $\lambda_3 \lambda_1 X_{31} = \lambda_1 X_{31} X_{11} + \lambda_3 X_{33} X_{31}$
\end{enumerate}

Let us analyze the condition for a non-trivial solution for $X_{21}$. The equation can be rewritten as:
\[
(\lambda_2 X_{22} - \lambda_1 \lambda_2 I) X_{21} + \lambda_1 X_{21} X_{11} = 0.
\]
This is a homogeneous Sylvester equation of the form $AX - XB = 0$. A non-trivial solution for $X_{21}$ exists if and only if the spectra of the coefficient matrices, $\sigma(\lambda_2 X_{22} - \lambda_1 \lambda_2 I)$ and $\sigma(-\lambda_1 X_{11})$, have a common element.

The spectra are determined by the spectra of $X_{11}$ and $X_{22}$:
\begin{itemize}
    \item $\sigma(-\lambda_1 X_{11}) \subseteq \{0, -\lambda_1^2\}$
    \item $\sigma(\lambda_2 X_{22} - \lambda_1 \lambda_2 I) \subseteq \{-\lambda_1 \lambda_2, \lambda_2^2 - \lambda_1 \lambda_2\}$
\end{itemize}

Given that the eigenvalues $\lambda_1, \lambda_2$ are distinct and non-zero, an intersection can only occur if $\lambda_2^2 - \lambda_1 \lambda_2 = - \lambda_1^2$. This simplifies to the condition:
\[
\lambda_1^2 - \lambda_1 \lambda_2 + \lambda_2^2 = 0.
\]

If this condition on the eigenvalues holds, the corresponding Sylvester equation admits non-trivial solutions for $X_{21}$, which can then be fully characterized.

The analysis for $X_{23}$ and $X_{31}$ is perfectly analogous. Non-trivial solutions for these blocks exist if and only if the corresponding pairs of eigenvalues satisfy similar algebraic constraints:
\begin{itemize}
    \item For $X_{23}$: $\lambda_2^2 - \lambda_2 \lambda_3 + \lambda_3^2 = 0$.
    \item For $X_{31}$: $\lambda_3^2 - \lambda_3 \lambda_1 + \lambda_1^2 = 0$.
\end{itemize}

\end{document}
